---
title: 自动添加文件发布时间
date: '2024-12-10 23:25:02'
description: 自动给文档添加发布时间
category: "vite-press"
tags:
  - Git
  - javascript
  - Node

---
# 自动添加文件发布时间

背景：写了一些文档，打算根据文档创建时间生成 time-line 页面，但不想手动为每个文件添加其发布时间。



## 需要解决的问题
1. 如何拿到文件的创建时间
2. 找到需要添加文件发布时间的文件
3. 如何从源文件提取出元数据，对应已经含有文件发布时间的文件则不需要处理。
4. 如何将时间添加到元数据中


## 获取文档创建时间
首先想到的是从 git 仓库中获取文件提交时间，但是发现这个功能并不支持，但是可用拿到文件的提交记录，然后根据提交记找到文件第一次提交时间，将其当作文件发布时间。
在命令行开始测试 `git log --follow --format=%ad -- ${ filePath }` 这个命令会拿到文件的所有提交记录，从中可以拿到第一次提交的时间

## 找到需要添加文件发布时间的文件
需要找到目录下所有 .md 文件，这里使用 glob 模块来实现

## 获取文件发布时间
需要先读取到源文件，使用`gary-matter` 来提取出元数据。

## 添加文件发布时间

使用 `gary-matter`的`stringify`方法将其转化为字符串写会源文件

<<< ../.vitepress/utils/getPublishTime.ts



